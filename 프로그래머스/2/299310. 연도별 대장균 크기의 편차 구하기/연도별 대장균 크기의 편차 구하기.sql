

WITH view AS (
    -- 연도 칼럼 추가, 필요한 정보(대장균 ID, 대장균 크기), 연도별 가장 큰 대장균 크기 칼럼
    SELECT
        ID,
        YEAR(DIFFERENTIATION_DATE) AS YEAR,
        MAX(SIZE_OF_COLONY) OVER (PARTITION BY YEAR(DIFFERENTIATION_DATE)) AS LARGEST_SIZE,
        SIZE_OF_COLONY
    FROM ECOLI_DATA
)

SELECT
    YEAR,
    LARGEST_SIZE - SIZE_OF_COLONY AS YEAR_DEV,
    ID
FROM view
ORDER BY YEAR ASC, LARGEST_SIZE - SIZE_OF_COLONY ASC

















